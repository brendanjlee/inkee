import React, { useEffect, useState } from "react";
import { Link } from "react-router-dom";
import { Button, Form, FormGroup, FormSelect } from "react-bootstrap";

import CreateHeader from "../../components/header/header";
import './createLobby.css'

function CreateLobby({socket, history}) {
  const [numRounds, setNumRounds] = useState(2);
  const [roundLength, setRoundLength] = useState(30);
  const [customWords, setCustomWords] = useState('');

  const handleNumRoundChange = (event) => {
    console.log(`Num Rounds: ${event.target.value}`);
    setNumRounds(event.target.value);
  };

  const handleRoundLengthChange = (event) => {
    console.log(`Round Length: ${event.target.value}`);
    setRoundLength(event.target.value);
  };
  
  const handleSubmit = (event) => {
    event.preventDefault();
    console.log('Form Submit');
    console.log(`Submit: numRounds: ${numRounds}`);
    console.log(`Submit: roundLength: ${roundLength}`);
    console.log(`Submit: customWords: ${customWords}`)

    socket.emit('createGame', {
      gameConfiguration: {
        num_rounds: numRounds,
        round_length: roundLength,
      },
      userData: {
        username: history.location.state.username,
        avatar: history.location.state.avatar,
      },
    });

    socket.on('inviteCode', (inviteCode) => {
      // Join game room generated by server.
      socket.emit('joinRoom', inviteCode);

      history.push({
        pathname: '/prestartLobby',
        state: {
          inviteCode: inviteCode,
        }
      });
    });
  };

  return (
    <div className='root'>
      <CreateHeader />
      <div className='content'>
        <h2>Select Game Settings</h2>
        <form className='lobby-creation-div' onSubmit={handleSubmit}>
          <div className="form-group">
              <label htmlFor="numRounds">Rounds: </label>
              <select
                id="numRounds"
                name="numRounds"
                onChange={handleNumRoundChange}
                value={numRounds}
              >
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
              </select>
          </div> 
          <div className="form-group">
            <label htmlFor="roundLength">Drawing Time (seconds): </label>
            <select
              id="roundLength"
              name="roundLength"
              onChange={handleRoundLengthChange}
              value={roundLength}
            >
              <option value="30">30</option>
              <option value="40">40</option>
              <option value="50">50</option>
              <option value="60">60</option>
              <option value="70">70</option>
              <option value="80">80</option>
              <option value="90">90</option>
              <option value="100">100</option>
              <option value="110">110</option>
              <option value="120">120</option>
              <option value="130">130</option>
              <option value="140">140</option>
              <option value="150">150</option>
              <option value="160">160</option>
              <option value="170">170</option>
              <option value="180">180</option>
            </select>
          </div>
          <div className='wordlist-container'>
            <label>Custom Words:</label>
            <textarea
              placeholder='Enter Custom Words...'
              value={customWords}
              onChange={e => setCustomWords(e.target.value)}
              >
            </textarea>
          </div> 
          <Link to='/prestartLobby'>
            <Button variant='primary'>Start Game</Button>
          </Link>
          <button>send</button>
        </form>
      </div>
    </div>
  );
}

export default CreateLobby